<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="AngusWG">
        <link rel="canonical" href="https://anguswg.github.io/simple_blog/%E9%A1%B9%E7%9B%AE/%E9%9F%AD%E8%8F%9C%E7%9A%84%E8%82%A1%E5%B8%82%E7%A0%94%E7%A9%B6/">
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>韭菜的股市研究 - AngusWG Blog</title>
        <link href="../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/color-brewer.min.css">

        <script src="../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../..">AngusWG Blog</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href="../.." class="nav-link">Home</a>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">随笔 <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../%E9%9A%8F%E7%AC%94/%E8%BF%9C%E7%A8%8B%E5%B7%A5%E4%BD%9C%E5%88%86%E6%9E%90/" class="dropdown-item">远程工作分析</a>
</li>
                                    
<li>
    <a href="../../%E9%9A%8F%E7%AC%94/git%E8%AE%BE%E7%BD%AE%E4%BB%A3%E7%90%86/" class="dropdown-item">git设置代理</a>
</li>
                                    
<li>
    <a href="../../%E9%9A%8F%E7%AC%94/%E6%80%9D%E7%BB%B4%E4%BA%A7%E5%93%81%E8%AF%BE/" class="dropdown-item">思维产品课</a>
</li>
                                    
<li>
    <a href="../../%E9%9A%8F%E7%AC%94/%E6%B0%B8%E4%B9%85%E5%85%B3%E9%97%ADWPS%E7%83%AD%E7%82%B9%E3%80%81%E4%BA%91%E6%9C%8D%E5%8A%A1/" class="dropdown-item">永久关闭WPS热点、云服务</a>
</li>
                                    
<li>
    <a href="../../%E9%9A%8F%E7%AC%94/%E9%87%8F%E5%8C%96%E7%9B%B8%E5%85%B3/" class="dropdown-item">量化相关</a>
</li>
                                    
<li>
    <a href="../../%E9%9A%8F%E7%AC%94/win10%20%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E7%9B%B8%E5%85%B3/" class="dropdown-item">win10 开发环境相关</a>
</li>
                                    
<li>
    <a href="../../%E9%9A%8F%E7%AC%94/%E4%B8%A4%E5%8F%B0Nginx%20socketio%E6%97%A0%E6%B3%95%E9%80%9A%E8%BF%87/" class="dropdown-item">两台Nginx socketio无法通过</a>
</li>
                                    
<li>
    <a href="../../%E9%9A%8F%E7%AC%94/RQPro2.0%E6%9C%AC%E5%9C%B0%E7%8E%AF%E5%A2%83%E4%B8%8EVS%20code%20%E9%9B%86%E6%88%90/" class="dropdown-item">RQPro2.0本地环境与VS code 集成</a>
</li>
                                    
<li>
    <a href="../../%E9%9A%8F%E7%AC%94/%E4%BC%81%E4%B8%9A%E5%90%8D%E6%A8%A1%E7%B3%8A%E6%9F%A5%E8%AF%A2%E8%B0%83%E7%A0%94/" class="dropdown-item">企业名模糊查询调研</a>
</li>
                                    
<li>
    <a href="../../%E9%9A%8F%E7%AC%94/socketio%20%E7%AC%AC%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B%E5%A4%B1%E8%B4%A5%E9%97%AE%E9%A2%98/" class="dropdown-item">socketio 第三次握手失败问题</a>
</li>
                                    
<li>
    <a href="../../%E9%9A%8F%E7%AC%94/cmder%20%E9%80%9A%E8%BF%87%E8%B7%B3%E8%BD%AC%E6%9C%BA%20rz%20sz%20%E4%BC%A0%E8%BE%93%E6%96%87%E4%BB%B6/" class="dropdown-item">cmder 通过跳转机 rz sz 传输文件</a>
</li>
                                    
<li>
    <a href="../../%E9%9A%8F%E7%AC%94/%E5%A6%82%E4%BD%95%E6%84%89%E5%BF%AB%E7%9A%84%E9%AD%82%E7%A9%BF%E5%88%B0%E5%85%AC%E5%8F%B8%E2%80%94%E2%80%94%E5%86%85%E7%BD%91%E8%BF%9E%E6%8E%A5%E6%8C%87%E5%8D%97/" class="dropdown-item">如何愉快的魂穿到公司——内网连接指南</a>
</li>
                                    
<li>
    <a href="../../%E9%9A%8F%E7%AC%94/conda%E4%B8%8Erqdatac%E6%95%99%E7%A8%8B/" class="dropdown-item">conda与rqdatac教程</a>
</li>
                                    
<li>
    <a href="../../%E9%9A%8F%E7%AC%94/outlook%2Bjira%2Bto-do/" class="dropdown-item">outlook+jira+to-do</a>
</li>
                                    
<li>
    <a href="../../%E9%9A%8F%E7%AC%94/LINK%20fatal%20error%20LNK1158%20cannot%20run%20%27rc.exe%27/" class="dropdown-item">LINK fatal error LNK1158 cannot run 'rc.exe'</a>
</li>
                                    
<li>
    <a href="../../%E9%9A%8F%E7%AC%94/%E4%B8%80%E4%B8%AAjs%E7%A0%B4%E8%A7%A3%E9%97%AE%E9%A2%98%E8%AE%B0%E5%BD%95/" class="dropdown-item">一个js破解问题记录</a>
</li>
                                    
<li>
    <a href="../../%E9%9A%8F%E7%AC%94/PyCharm%E5%8F%8Avscode%E5%BF%AB%E9%80%9F%E9%85%8D%E7%BD%AERQSDK%E4%B8%8A%E6%89%8B%20%E8%AF%B4%E6%98%8E%E6%96%87%E6%A1%A3/" class="dropdown-item">PyCharm及vscode快速配置RQSDK上手 说明文档</a>
</li>
                                    
<li>
    <a href="../../%E9%9A%8F%E7%AC%94/pycharm%E5%A6%82%E4%BD%95%E5%90%8C%E6%97%B6%E7%BC%96%E8%BE%91%E5%A4%9A%E8%A1%8C/" class="dropdown-item">pycharm如何同时编辑多行</a>
</li>
                                    
<li>
    <a href="../../%E9%9A%8F%E7%AC%94/wsl%20%E4%B8%8A%E8%A3%85node/" class="dropdown-item">wsl 上装node</a>
</li>
                                    
<li>
    <a href="../../%E9%9A%8F%E7%AC%94/%E4%B9%90%E7%90%86%E7%AC%94%E8%AE%B0/" class="dropdown-item">乐理笔记</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">项目 <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../%E7%BD%91%E6%98%93%E4%BA%91%E6%B6%88%E6%81%AF%E6%8E%A8%E9%80%81%E6%AD%8C%E6%9B%B2%E6%94%B6%E9%9B%86/" class="dropdown-item">网易云消息推送歌曲收集</a>
</li>
                                    
<li>
    <a href="../%E7%BC%96%E7%A8%8B%E5%85%B4%E8%B6%A3%E5%B0%8F%E7%BB%84%E6%8B%9B%E4%BA%BA/" class="dropdown-item">编程兴趣小组招人</a>
</li>
                                    
<li>
    <a href="./" class="dropdown-item active">韭菜的股市研究</a>
</li>
                                    
<li>
    <a href="../GBI%E9%A1%B9%E7%9B%AE%E7%9F%A5%E8%AF%86%E7%82%B9/" class="dropdown-item">GBI项目知识点</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">编程 <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../%E7%BC%96%E7%A8%8B/StarUML%E7%A0%B4%E8%A7%A3/" class="dropdown-item">StarUML破解</a>
</li>
                                    
<li>
    <a href="../../%E7%BC%96%E7%A8%8B/%E7%BC%96%E7%A8%8B%E6%96%B9%E5%BC%8F/" class="dropdown-item">编程方式</a>
</li>
                                    
<li>
    <a href="../../%E7%BC%96%E7%A8%8B/%E5%85%B3%E4%BA%8E%E7%BC%96%E7%A8%8B/" class="dropdown-item">关于编程</a>
</li>
                                    
<li>
    <a href="../../%E7%BC%96%E7%A8%8B/centos%20%E9%87%8D%E8%A3%85yum%E4%B8%8Epython/" class="dropdown-item">centos 重装yum与python</a>
</li>
                                    
<li>
    <a href="../../%E7%BC%96%E7%A8%8B/python%E8%AE%BE%E8%AE%A1%E8%B5%84%E6%96%99/" class="dropdown-item">python设计资料</a>
</li>
                                    
<li>
    <a href="../../%E7%BC%96%E7%A8%8B/%E4%BB%A3%E6%9B%BFsupervisor%20-%20gosuv/" class="dropdown-item">代替supervisor - gosuv</a>
</li>
                                    
<li>
    <a href="../../%E7%BC%96%E7%A8%8B/%E6%9B%B4%E4%BC%98%E9%9B%85%E7%9A%84%E7%94%9F%E6%88%90requirements.txt/" class="dropdown-item">更优雅的生成requirements.txt</a>
</li>
                                    
<li>
    <a href="../../%E7%BC%96%E7%A8%8B/Sphinx%20%E7%BC%96%E8%AF%91%E6%8A%A5%E9%94%99nonlocal%20open_cite_tag/" class="dropdown-item">Sphinx 编译报错nonlocal open_cite_tag</a>
</li>
                                    
<li>
    <a href="../../%E7%BC%96%E7%A8%8B/%E5%9B%BD%E5%86%85%20github%20%E6%85%A2/" class="dropdown-item">国内 github 慢</a>
</li>
                                    
<li>
    <a href="../../%E7%BC%96%E7%A8%8B/mongodb%20%E6%8E%92%E5%BA%8F%20%E6%A0%B9%E6%8D%AE%20_id%20%E6%8F%92%E5%85%A5%20%E6%B5%8B%E8%AF%95/" class="dropdown-item">mongodb 排序 根据 _id 插入 测试</a>
</li>
                                    
<li>
    <a href="../../%E7%BC%96%E7%A8%8B/ss/" class="dropdown-item">ss</a>
</li>
                                    
<li>
    <a href="../../%E7%BC%96%E7%A8%8B/frp%20%E6%9C%8D%E5%8A%A1%E5%99%A8%20%E6%A0%91%E8%8E%93%E6%B4%BE%20%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/" class="dropdown-item">frp 服务器 树莓派 内网穿透</a>
</li>
                                    
<li>
    <a href="../../%E7%BC%96%E7%A8%8B/%E6%A0%91%E8%8E%93%E6%B4%BE%20%E8%87%AA%E5%8A%A8%E6%8C%82%E8%BD%BD/" class="dropdown-item">树莓派 自动挂载</a>
</li>
                                    
<li>
    <a href="../../%E7%BC%96%E7%A8%8B/zsh%E5%AE%89%E8%A3%85/" class="dropdown-item">zsh安装</a>
</li>
                                    
<li>
    <a href="../../%E7%BC%96%E7%A8%8B/%E6%A0%91%E8%8E%93%E6%B4%BE%2Bmotion%20%E6%90%AD%E5%BB%BA%E6%91%84%E5%83%8F%E5%A4%B4%E7%9B%91%E6%8E%A7%E7%B3%BB%E7%BB%9F/" class="dropdown-item">树莓派+motion 搭建摄像头监控系统</a>
</li>
                                    
<li>
    <a href="../../%E7%BC%96%E7%A8%8B/google.protobuf.Timestamp%20is%20not%20defined/" class="dropdown-item">google.protobuf.Timestamp is not defined</a>
</li>
                                    
<li>
    <a href="../../%E7%BC%96%E7%A8%8B/Jenkins%20pipeline%20%E6%9E%84%E5%BB%BA%E5%90%8E%E5%8F%91%E7%BB%99%E6%8F%90%E4%BA%A4%E8%80%85%28%E8%A7%A6%E5%8F%91%E8%80%85%29%E9%82%AE%E4%BB%B6/" class="dropdown-item">Jenkins pipeline 构建后发给提交者(触发者)邮件</a>
</li>
                                    
<li>
    <a href="../../%E7%BC%96%E7%A8%8B/%E8%B0%83%E5%BA%A6%E7%AE%97%E6%B3%95%E8%AE%B0%E5%BD%95/" class="dropdown-item">调度算法记录</a>
</li>
                                    
<li>
    <a href="../../%E7%BC%96%E7%A8%8B/windows%E4%B8%8A%E7%9A%84docker/" class="dropdown-item">windows上的docker</a>
</li>
                                    
<li>
    <a href="../../%E7%BC%96%E7%A8%8B/%E5%A4%8D%E4%B9%A0%E7%AC%94%E8%AE%B0/" class="dropdown-item">复习笔记</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Python <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../Python/%E7%94%A8pycharm%E8%A3%85%E5%8C%85%E5%87%BA%E7%8E%B0pycharm%20The%20repository%20located%20at%20pypi%20douban%20com%20is%20not%20a/" class="dropdown-item">用pycharm装包出现pycharm The repository located at pypi douban com is not a</a>
</li>
                                    
<li>
    <a href="../../Python/%E5%AE%89%E8%A3%85mysqlclient%E6%8A%A5%E9%94%99%E9%97%AE%E9%A2%98/" class="dropdown-item">安装mysqlclient报错问题</a>
</li>
                                    
<li>
    <a href="../../Python/python3%20-%20mysql%20%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/" class="dropdown-item">python3 - mysql 数据存储性能测试</a>
</li>
                                    
<li>
    <a href="../../Python/%E8%A7%A3%E5%86%B3Flask-SQLAlchemy%202006%20MySQL%20server%20has%20gone%20away%20%E9%97%AE%E9%A2%98/" class="dropdown-item">解决Flask-SQLAlchemy 2006 MySQL server has gone away 问题</a>
</li>
                                    
<li>
    <a href="../../Python/Python%20Pypi%20Server/" class="dropdown-item">Python Pypi Server</a>
</li>
                                    
<li>
    <a href="../../Python/%E5%9C%A8%E6%8E%A7%E5%88%B6%E5%8F%B0%EF%BC%88console%EF%BC%89%E6%89%A7%E8%A1%8Cpython%E6%96%87%E4%BB%B6%E3%80%81debug%20python%E7%A8%8B%E5%BA%8F/" class="dropdown-item">在控制台（console）执行python文件、debug python程序</a>
</li>
                                    
<li>
    <a href="../../Python/flask_schedule%20logging%20%E5%A4%9A%E8%BF%9B%E7%A8%8B%20%E9%97%AE%E9%A2%98/" class="dropdown-item">flask_schedule logging 多进程 问题</a>
</li>
                                    
<li>
    <a href="../../Python/python%20%E6%97%B6%E9%97%B4%E6%88%B3%E9%97%AE%E9%A2%98/" class="dropdown-item">python 时间戳问题</a>
</li>
                                    
<li>
    <a href="../../Python/%E8%BD%AC%20%E7%9B%98%E7%82%B9%20Python%20%E4%B8%AD%E7%9A%84%E9%82%A3%E4%BA%9B%E5%86%B7%E7%9F%A5%E8%AF%86/" class="dropdown-item">转 盘点 Python 中的那些冷知识</a>
</li>
                                    
<li>
    <a href="../../Python/flask_admin%20csv%20%E5%AF%BC%E5%87%BA%20%20%E4%B8%AD%E6%96%87%E4%B9%B1%E7%A0%81%E9%97%AE%E9%A2%98/" class="dropdown-item">flask_admin csv 导出  中文乱码问题</a>
</li>
                                    
<li>
    <a href="../../Python/win10%E8%87%AA%E5%B8%A6Ubuntu%E4%BD%BF%E7%94%A8win10%E7%9A%84python%E6%96%B9%E5%BC%8F/" class="dropdown-item">win10自带Ubuntu使用win10的python方式</a>
</li>
                                    
<li>
    <a href="../../Python/python%20prometheus%20gunicorn%20%E5%A4%9A%E8%BF%9B%E7%A8%8B%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/" class="dropdown-item">python prometheus gunicorn 多进程解决方案</a>
</li>
                                    
<li>
    <a href="../../Python/python%20%E6%80%A7%E8%83%BD%E5%88%86%E6%9E%90/" class="dropdown-item">python 性能分析</a>
</li>
                                    
<li>
    <a href="../../Python/sqlalchemy%20%E5%A4%9A%E7%BB%84%E6%9D%A1%E4%BB%B6%E6%9F%A5%E8%AF%A2/" class="dropdown-item">sqlalchemy 多组条件查询</a>
</li>
                                    
<li>
    <a href="../../Python/flask_babelex%20%E4%BD%BF%E7%94%A8/" class="dropdown-item">flask_babelex 使用</a>
</li>
                                    
<li>
    <a href="../../Python/flask_admin%E8%AE%BE%E7%BD%AE%E5%AE%BD%E5%BA%A6%E4%B8%BA%E5%85%A8%E5%B1%8F/" class="dropdown-item">flask_admin设置宽度为全屏</a>
</li>
                                    
<li>
    <a href="../../Python/flask_admin%20%E4%B8%BB%E9%A1%B5%E6%94%AF%E6%8C%81markdown%E5%86%99%E5%85%A5/" class="dropdown-item">flask_admin 主页支持markdown写入</a>
</li>
                                    
<li>
    <a href="../../Python/pip%E4%BF%AE%E6%94%B9%E4%B8%BA%E8%B1%86%E7%93%A3%E6%BA%90%20%E8%84%9A%E6%9C%AC/" class="dropdown-item">pip修改为豆瓣源 脚本</a>
</li>
                                    
<li>
    <a href="../../Python/pycharm%E9%97%AE%E9%A2%98/" class="dropdown-item">pycharm问题</a>
</li>
                                </ul>
                            </li>
                            <li class="navitem">
                                <a href="../../about/" class="nav-link">About</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../%E7%BC%96%E7%A8%8B%E5%85%B4%E8%B6%A3%E5%B0%8F%E7%BB%84%E6%8B%9B%E4%BA%BA/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../GBI%E9%A1%B9%E7%9B%AE%E7%9F%A5%E8%AF%86%E7%82%B9/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#_1" class="nav-link">韭菜的股市研究</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#_2" class="nav-link">写在前面的话</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#_3" class="nav-link">关于如何读这个图</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#x-3" class="nav-link">检测低于 x 元的 股票 ，购买并持有3个礼拜后抛出</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#_4" class="nav-link">根据公众号 闷声发小财</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#90" class="nav-link">检测行业因子普遍(90%)一周内上涨的低价股票</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#macd" class="nav-link">普通macd均线策略</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#a" class="nav-link">朋友想法A</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#_5" class="nav-link">总结</a>
              <ul class="nav flex-column">
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="_1">韭菜的股市研究<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h1>
<h1 id="_2">写在前面的话<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h1>
<ul>
<li>通过<a href="https://www.ricequant.com">米筐</a>网站提供的量化平台进行的测试。    </li>
<li>做这个研究的初衷是笔者有一点意象投资股市，有几个不同的投资方案（策略），我想先拿19年的数据跑一跑我的方案（策略），如果亏钱了，就不玩股市，老老实实玩基金了。    </li>
</ul>
<p><img alt="" src="../../images/7485616-1c96c111c13fb20f.png" />    </p>
<hr />
<h1 id="_3">关于如何读这个图<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h1>
<p><img alt="" src="../../images/7485616-51a342b54481a99f.png" />    </p>
<ul>
<li>首先能看到时间，我的数据是从<code>2019年01 -- 2020年01</code>,    </li>
<li>红色的线代表账户市值（把股票持仓也换算成钱）的变化。    </li>
<li>蓝色的线代表基准（沪深三百）的市值变化。    </li>
<li>其次最重要的指标，<code>回测收益</code>，表示的是我本金到时间结束，涨了多少，比如我有5w，那么这个图表示我年末结束涨到了 <code>5*(0.09+1) = 5.45(万元)</code>。    </li>
<li>然后平均一年能有13.5%的收益。    </li>
<li>然后看<code>基准收益</code>,这个我一般设置的是沪深三百，也就是大盘，这个图表示19年大盘涨了<code>30+%</code>，而我的策略只有<code>9+%</code>，其实是没有跑赢大盘的(<em>还不如买基金</em>)。    </li>
<li>然后需要注意下一个指标&rdquo;MaxDrawdown(最大回测)&rdquo;:最大回撤是最常用的指标，描述了投资者可能面临的最大亏损。最大回撤的数值越小越好，越大说明风险越大。    </li>
<li>Sharpe(夏普率)：夏普比率若为正值，代表基金报酬率大于风险；若为负值，代表基金风险大于报酬率。因此，夏普比率越高，投资组合越佳。    </li>
</ul>
<p>好了，下面开始正文。    </p>
<hr />
<h1 id="x-3">检测低于 x 元的 股票 ，购买并持有3个礼拜后抛出<a class="headerlink" href="#x-3" title="Permanent link">&para;</a></h1>
<p>这个是一个普遍的购买思路，觉得底价股票一定会长，我短期持有然后等他高于某个价格就出售，我模拟一下这个情况，下面是代码:    </p>
<pre><code>#!/usr/bin/python3    
# encoding: utf-8     
# @Time    : 2020/11/18 14:32    
# @author  : zza    
# @Email   : 740713651@qq.com    

import warnings    

import pandas    
import rqdatac    

__config__ = {    
    &quot;base&quot;: {    
        &quot;start_date&quot;: &quot;20190101&quot;,    
        &quot;end_date&quot;: &quot;20191231&quot;,    
        'frequency': '1d',    
        &quot;accounts&quot;: {    
            &quot;stock&quot;: 5000,    
        }    
    },    
    &quot;mod&quot;: {    
        &quot;sys_progress&quot;: {    
            &quot;enabled&quot;: True,    
            &quot;show&quot;: True    
        }, &quot;sys_accounts&quot;: {    
            &quot;enabled&quot;: True,    
            &quot;dividend_reinvestment&quot;: True,    
        },    
        &quot;sys_analyser&quot;: {    
            &quot;enabled&quot;: True,    
            &quot;plot&quot;: True,    
            'benchmark': '000300.XSHG',    
        },    
    }    
}    


def init(context):    
    context.lowest = 5    
    context.highest = 5.9    
    context.day_count = 0    
    context.holding_days = 10    


def get_ticker(context):    
    all_ins = rqdatac.all_instruments(&quot;Stock&quot;).order_book_id.to_list()    
    price_df = rqdatac.get_price(all_ins, context.now, context.now, expect_df=True, fields=['close'])    
    price_df = price_df.reset_index(drop=False)    
    price_df = price_df[(context.lowest &lt;= price_df.close) &amp; (price_df.close &lt;= context.highest)]    

    start_date = rqdatac.get_previous_trading_date(context.now, 2)    
    price_df_2 = rqdatac.get_price(price_df.order_book_id.to_list(), start_date, context.now, expect_df=True,    
                                   fields=['close']).reset_index(drop=False)    
    order_ticker = []    
    for order_book_id, data_df in price_df_2.groupby(price_df_2.order_book_id):    
        if (data_df.close.shift(fill_value=0) &lt; data_df.close).all():    
            order_ticker.append(order_book_id)    

    return order_ticker    


def before_trading(context):    
    context.day_count += 1    
    if (context.day_count - 1) % context.holding_days == 0:    
        context.order_ticker = get_ticker(context)    


def handle_bar(context, bar_dict):    
    if (context.day_count - 1) % context.holding_days == 0:    
        with warnings.catch_warnings():    
            for item in context.order_ticker:    
                o = order_target_value(item, 1000)    
                if o:    
                    print(o)    

    if (context.day_count - 1) % context.holding_days == (context.holding_days-1):    
        for item in context.portfolio.positions.keys():    
            order_target_value(item, 0)    


def after_trading(context):    
    print(&quot;total_value {}&quot;.format(context.portfolio.total_value))    
    if (context.day_count - 1) % 15 == 0:    
        items = []    
        for k, v in context.portfolio.positions.items():    
            items.append({&quot;order_book_id&quot;: k, &quot;quantity&quot;: v.quantity})    
        print(pandas.DataFrame(items))    


if __name__ == '__main__':    
    import rqalpha    

    rqalpha.run_func(init=init,    
                     before_trading=before_trading,    
                     handle_bar=handle_bar,    
                     after_trading=after_trading,    
                     config=__config__)    
</code></pre>
<ul>
<li>
<p>持有3个交易日  <br />
<img alt="image.png" src="../../images/7485616-8569afe109aec098.png" />    </p>
</li>
<li>
<p>持有10个交易日  <br />
<img alt="" src="../../images/7485616-51a342b54481a99f.png" />    </p>
</li>
<li>
<p>持有15个交易日  <br />
<img alt="" src="../../images/7485616-9691060006e68543.png" />    </p>
</li>
</ul>
<p>结论：底价股票确实会随着大盘的涨而有一定的波动，但最终都是会赔钱的，且三个交易的日的时候，直接赔钱了。这个图可以给广大读者的保佑侥幸心里的朋友看看，<code>一年忙到头，不如买国运（沪深三百）。</code>    </p>
<hr />
<h1 id="_4">根据公众号 闷声发小财<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h1>
<p>这个是根据我一个朋友跑的算法跑出来的可能会涨的概率。笔者拿到了他一年的数据（没用爬虫），然后试试能不能涨，这么跑的原因是，我当初确实想按着他的这个公众号来买，不过既然有回放数据测试，我当然先测试一下，本金本来就不多，挥霍不了，不敢随便教学费。    </p>
<p><img alt="" src="../../images/7485616-62eef7d048ae0aca.png" />    </p>
<p>策略如下：    </p>
<pre><code class="language-python">#!/usr/bin/python3    
# encoding: utf-8     
# @Time    : 2020/11/22 16:33    
# @author  : zza    
# @Email   : 740713651@qq.com    
# @File    : 闷声发小财.py    

import warnings    

import numpy    
import pandas    
import rqdatac    
from rqalpha.apis import *    

__config__ = {    
    &quot;base&quot;: {    
        &quot;start_date&quot;: &quot;20190101&quot;,    
        &quot;end_date&quot;: &quot;20191231&quot;,    
        'frequency': '1d',    
        &quot;accounts&quot;: {    
            &quot;stock&quot;: 5000,    
        },    
        &quot;data_bundle_path&quot;: r&quot;E:\data\bundle&quot;,    
    },    
    &quot;extra&quot;: {    
        &quot;log_level&quot;: &quot;debug&quot;,    
    },    
    &quot;mod&quot;: {    
        &quot;sys_progress&quot;: {    
            &quot;enabled&quot;: True,    
            &quot;show&quot;: True    
        }, &quot;sys_accounts&quot;: {    
            &quot;enabled&quot;: True,    
            &quot;dividend_reinvestment&quot;: True,    
        },    
        &quot;sys_analyser&quot;: {    
            &quot;enabled&quot;: True,    
            &quot;plot&quot;: True,    
            'benchmark': '000300.XSHG',    
        },    
    },    
}    


def init(context):    
    context.df = pandas.read_csv(&quot;发小财.csv&quot;, dtype={&quot;股票代码&quot;: numpy.str})    
    context.df['order_book_id'] = rqdatac.id_convert(context.df[&quot;股票代码&quot;].to_list())    
    context.used_df = context.df[context.df[&quot;预测结果&quot;] &gt; 0.7]    
    context.sell_multiple = 1.08    
    context.holding_days = 1    
    context.buy_queen = []    
    context.sell_map = {}    


def before_trading(context):    
    print(&quot;当日购买:{}&quot;.format(context.buy_queen))    
    print(&quot;当日持仓:{}&quot;.format(list(context.sell_map.keys())))    


def handle_bar(context, bar_dict):    
    while context.buy_queen:    
        order_book_id = context.buy_queen.pop()    
        if context.stock_account.cash &gt; 1000:    
            o = order_value(order_book_id, 1000)    
            if o:    
                trading_dt = get_next_trading_date(context.now, context.holding_days).to_pydatetime()    
                context.sell_map[order_book_id] = trading_dt    
                print(&quot;[{}] 购买成功&quot;.format(order_book_id))    
        else:    
            print(&quot;[{}]资金不足，无法购买&quot;.format(order_book_id))    
    for order_id, dt in context.sell_map.copy().items():    
        a = dt.date() &lt;= context.now.date()    
        b = bar_dict[order_id].close &gt; get_position(order_id).avg_price # * context.sell_multiple    
        if a and b:    
            o = order_percent(order_id, -1)    
            if o:    
                del context.sell_map[order_id]    
                print(&quot;[{}] 卖出成功&quot;.format(order_id))    


def dt_to_int(dt):    
    return dt.year * 10000 + dt.month * 100 + dt.day    


def after_trading(context):    
    df = context.used_df[dt_to_int(context.now) == context.used_df.trading_dt]    
    if df.empty:    
        return    
    else:    
        for _, item in df.iterrows():    
            context.buy_queen.append(item[&quot;order_book_id&quot;])    


if __name__ == '__main__':    
    import rqalpha    

    rqalpha.run_func(init=init,    
                     before_trading=before_trading,    
                     handle_bar=handle_bar,    
                     after_trading=after_trading,    
                     config=__config__)    

</code></pre>
<ul>
<li>
<p>持有一天就卖出  <br />
<img alt="image.png" src="../../images/7485616-ce22382ae9b86dbf.png" />    </p>
</li>
<li>
<p>持有3天并价格高于持仓价则卖出    </p>
</li>
</ul>
<p><img alt="image.png" src="../../images/7485616-24ba4353724ceeb5.png" />    </p>
<p>结论：还好跑了回放测试，不然得教好多学费。    </p>
<hr />
<h1 id="90">检测行业因子普遍(90%)一周内上涨的低价股票<a class="headerlink" href="#90" title="Permanent link">&para;</a></h1>
<p>这个也是我在上班的时候偶尔能想到的，我觉得可能也代表一分部分人的想法，<strong>某个行业市场涨幅的时候，必定是全行业性质的，且会持续一段时间。</strong>于是我就写了这个，根据股票行业暴露度（属于哪个行业），分类行业，如果都涨了，就买进，如果都跌了，就卖出。    </p>
<ul>
<li>检测行业因子普遍(90%)一周内上涨的低价股票 购买并持有    </li>
<li>在行业下跌在 30% 左右卖出    </li>
</ul>
<p>代码如下:    </p>
<pre><code class="language-python">#!/usr/bin/python3    
# encoding: utf-8     
# @Time    : 2020/11/22 16:33    
# @author  : zza    
# @Email   : 740713651@qq.com    
# @File    : 闷声发小财.py    
from collections import defaultdict    
from pprint import pprint    

import numpy    
import pandas    
from rqalpha.apis import *    

__config__ = {    
    &quot;base&quot;: {    
        &quot;start_date&quot;: &quot;20190101&quot;,    
        &quot;end_date&quot;: &quot;20191231&quot;,    
        'frequency': '1d',    
        &quot;accounts&quot;: {    
            &quot;stock&quot;: 50000,    
        },    
        &quot;data_bundle_path&quot;: r&quot;E:\data\bundle&quot;,    
    },    
    &quot;extra&quot;: {    
        &quot;log_level&quot;: &quot;debug&quot;,    
    },    
    &quot;mod&quot;: {    
        &quot;sys_progress&quot;: {    
            &quot;enabled&quot;: True,    
            &quot;show&quot;: True    
        }, &quot;sys_accounts&quot;: {    
            &quot;enabled&quot;: True,    
            &quot;dividend_reinvestment&quot;: True,    
        },    
        &quot;sys_analyser&quot;: {    
            &quot;enabled&quot;: True,    
            &quot;plot&quot;: True,    
            'benchmark': '000300.XSHG',    
        },    
    },    
}    


def get_holding_ticker():    
    # 请去米筐购买或申请试用 RQData : www.ricequant.com    
    rqdatac.init()    
    df = rqdatac.get_factor_exposure(rqdatac.all_instruments(&quot;Stock&quot;).order_book_id, &quot;20190101&quot;, &quot;20191231&quot;)    
    df.reset_index().sort_values(&quot;date&quot;).to_csv(&quot;factor_exposure.csv&quot;, index=False)    


def init(context):    
    df = pandas.read_csv(&quot;factor_exposure.csv&quot;)    
    all_order_book_id = all_instruments().order_book_id.to_list()    
    context.df = df[df[&quot;order_book_id&quot;].isin(all_order_book_id)]    
    context.buy_map = defaultdict(list)    
    context.holding_map = defaultdict(list)    
    context.sell_factors = []    
    context.day_count = 0    
    context.sell_multiple = 1.2    


def before_trading(context):    
    pprint(&quot;当日购买行业:{}&quot;.format(context.buy_map))    
    print(&quot;当日持仓:{}&quot;.format([i.order_book_id for i in get_positions()]))    
    print(&quot;年化:{}&quot;.format(context.portfolio.total_returns))    


def handle_bar(context, bar_dict):    
    # buy    
    for factors, order_book_ids in context.buy_map.items():    
        if context.stock_account.cash &lt; 2000:    
            break    
        for order_book_id in order_book_ids.copy():    
            o = order_value(order_book_id, 2000)    
            if o:    
                context.holding_map[factors].append(order_book_id)    
                order_book_ids.remove(order_book_id)    
    # sell    
    for factors in context.sell_factors:    
        for order_book_id in context.holding_map[factors].copy():    
            # a =  bar_dict[order_book_id].close &gt; get_position(order_book_id).avg_price * context.sell_multiple    
            a = True    
            if a:    
                o = order_percent(order_book_id, -1)    
                if o:    
                    context.holding_map[factors].remove(order_book_id)    


def dt_to_str(dt):    
    return &quot;{}-{}-{}&quot;.format(dt.year, dt.month, dt.day)    


def is_rise(order_book_id):    
    a, b = history_bars(order_book_id, 2, frequency=&quot;1d&quot;, fields='close')    
    return b &gt; a    


def after_trading(context):    
    context.day_count += 1    
    if context.day_count % 5 != 1:    
        return    
    df = context.df[context.now.date().isoformat() == context.df.date].copy()    
    df.loc[:, 'rose'] = df[&quot;order_book_id&quot;].apply(is_rise)    
    df.loc[:, 'close'] = df[&quot;order_book_id&quot;].apply(lambda x: history_bars(x, 1, frequency=&quot;1d&quot;, fields='close'))    
    context.sell_factors = []    
    context.buy_map = defaultdict(list)    
    for factors in df.columns[13:-2]:    
        _df = df[df[factors] == 1]    
        if _df['rose'].sum() / _df['order_book_id'].size &gt; 0.9:    
            context.buy_map[factors] = _df[(_df[&quot;close&quot;] &gt; 5) &amp; (_df[&quot;close&quot;] &lt; 6)].sort_values('close')[    
                                           'order_book_id'].to_list()[:2]    
        elif _df['rose'].sum() / _df['order_book_id'].size &lt; 0.3:    
            context.sell_factors.append(factors)    
    del df    


if __name__ == '__main__':    
    import rqalpha    

    rqalpha.run_func(init=init,    
                     before_trading=before_trading,    
                     handle_bar=handle_bar,    
                     after_trading=after_trading,    
                     config=__config__)    

</code></pre>
<ul>
<li>各行业两只股票  <br />
<img alt="" src="../../images/7485616-936944fb813c84b3.png" />    </li>
</ul>
<p>emmm，不说了，都是磊。    </p>
<hr />
<h1 id="macd">普通macd均线策略<a class="headerlink" href="#macd" title="Permanent link">&para;</a></h1>
<ul>
<li>这个是米筐官网的默认策略    </li>
</ul>
<pre><code>from collections import defaultdict    
from pprint import pprint    

import numpy    
import pandas    
from rqalpha.apis import *    

__config__ = {    
    &quot;base&quot;: {    
        &quot;start_date&quot;: &quot;20190101&quot;,    
        &quot;end_date&quot;: &quot;20191231&quot;,    
        'frequency': '1d',    
        &quot;accounts&quot;: {    
            &quot;stock&quot;: 50000,    
        },    
        &quot;data_bundle_path&quot;: r&quot;E:\data\bundle&quot;,    
    },    
    &quot;extra&quot;: {    
        &quot;log_level&quot;: &quot;debug&quot;,    
    },    
    &quot;mod&quot;: {    
        &quot;sys_progress&quot;: {    
            &quot;enabled&quot;: True,    
            &quot;show&quot;: True    
        }, &quot;sys_accounts&quot;: {    
            &quot;enabled&quot;: True,    
            &quot;dividend_reinvestment&quot;: True,    
        },    
        &quot;sys_analyser&quot;: {    
            &quot;enabled&quot;: True,    
            &quot;plot&quot;: True,    
            'benchmark': '000300.XSHG',    
        },    
    },    
}    

import talib    


def init(context):    
    context.s1 = '000300.XSHG'    

    context.SHORTPERIOD = 12    
    context.LONGPERIOD = 26    
    context.SMOOTHPERIOD = 9    
    context.OBSERVATION = 100    

    subscribe(context.s1)    


def before_trading(context):    
    pass    


def handle_bar(context, bar_dict):    
    closes = history_bars(context.s1, context.OBSERVATION, '1d', 'close')    

    diff, signal, _ = talib.MACD(closes)    

    if diff[-1] &gt; signal[-1] and diff[-2] &lt; signal[-2]:    
        order_target_percent(context.s1, 1)    

    if diff[-1] &lt; signal[-1] and diff[-2] &gt; signal[-2]:    
        order_target_percent(context.s1, 0)    


def after_trading(context):    
    pass    


if __name__ == '__main__':    
    import rqalpha    

    rqalpha.run_func(init=init,    
                     before_trading=before_trading,    
                     handle_bar=handle_bar,    
                     after_trading=after_trading,    
                     config=__config__)    
</code></pre>
<p><img alt="image.png" src="../../images/7485616-b1a34dc3b7e00d2a.png" />    </p>
<p>这个是根据大佬的代码抄的。其实数据还行，虽然没跑赢沪深三百，但是确实赚钱了，贴一下<a href="https://www.bilibili.com/video/BV1D54y1r7vH">源地址</a>,大佬说有一部分巧合在里面。不多说了。    </p>
<p>我结合下只买五块钱的情况    </p>
<pre><code>#!/usr/bin/python3    
# encoding: utf-8     
# @Time    : 2020/11/22 16:33    
# @author  : zza    
# @Email   : 740713651@qq.com    
# @File    : 闷声发小财.py    
import numpy    
import pandas    
from rqalpha.apis import *    

__config__ = {    
    &quot;base&quot;: {    
        &quot;start_date&quot;: &quot;20190101&quot;,    
        &quot;end_date&quot;: &quot;20191231&quot;,    
        'frequency': '1d',    
        &quot;accounts&quot;: {    
            &quot;stock&quot;: 50000,    
        },    
        &quot;data_bundle_path&quot;: r&quot;E:\data\bundle&quot;,    
    },    
    &quot;extra&quot;: {    
        &quot;log_level&quot;: &quot;debug&quot;,    
    },    
    &quot;mod&quot;: {    
        &quot;sys_progress&quot;: {    
            &quot;enabled&quot;: True,    
            &quot;show&quot;: True    
        }, &quot;sys_accounts&quot;: {    
            &quot;enabled&quot;: True,    
            &quot;dividend_reinvestment&quot;: True,    
        },    
        &quot;sys_analyser&quot;: {    
            &quot;enabled&quot;: True,    
            &quot;plot&quot;: True,    
            'benchmark': '000300.XSHG',    
        },    
    },    
}    

import talib    


def init(context):    
    context.s1 = '000300.XSHG'    

    context.SHORTPERIOD = 12    
    context.LONGPERIOD = 26    
    context.SMOOTHPERIOD = 9    
    context.OBSERVATION = 100    

    subscribe(context.s1)    
    context.lowest = 5    
    context.highest = 6    

    context.order_ticker = []    


def _history_bar_for_all_ins(x):    
    bar = history_bars(x, 1, &quot;1d&quot;, fields=['close'])    
    if not bar:    
        return numpy.nan    
    if bar[0]:    
        return bar[0][0]    
    return numpy.nan    


def get_ticker(context):    
    all_ins = all_instruments(&quot;Stock&quot;).order_book_id.to_list()    
    df = pandas.DataFrame(all_ins, columns=['order_book_id'])    
    df['close'] = df.order_book_id.apply(_history_bar_for_all_ins)    
    price_df = df[(context.lowest &lt;= df.close) &amp; (df.close &lt;= context.highest)]    

    order_ticker = []    
    for order_book_id in price_df.order_book_id.to_list():    
        c = pandas.Series(i[0] for i in history_bars(order_book_id, 3, &quot;1d&quot;, fields=['close']))    
        if (c.shift(fill_value=0) &lt; c).all():    
            order_ticker.append(order_book_id)    
    return order_ticker    


def before_trading(context):    
    print(&quot;年化:{}&quot;.format(context.portfolio.total_returns))    



def handle_bar(context, bar_dict):    
    closes = history_bars(context.s1, context.OBSERVATION, '1d', 'close')    

    diff, signal, _ = talib.MACD(closes)    

    if diff[-1] &gt; signal[-1] and diff[-2] &lt; signal[-2] :    
        if context.stock_account.cash &gt; 1000:    
            context.order_ticker = get_ticker(context)    
            for item in context.order_ticker:    
                o = order_target_value(item, 2000)    
                if o:    
                    print(o)    
            print(&quot;context.order_ticker&quot;, context.order_ticker)    

    if diff[-1] &lt; signal[-1] and diff[-2] &gt; signal[-2]:    
        for item in context.portfolio.positions.keys():    
            order_target_percent(item, 0)    


def after_trading(context):    
    context.order_ticker = []    
if __name__ == '__main__':    
    import rqalpha    

    rqalpha.run_func(init=init,    
                     before_trading=before_trading,    
                     handle_bar=handle_bar,    
                     after_trading=after_trading,    
                     config=__config__)    

</code></pre>
<p><img alt="image.png" src="../../images/7485616-45af14c68135119b.png" />    </p>
<p>还不如直接买华夏国运沪深三百。    </p>
<hr />
<h1 id="a">朋友想法A<a class="headerlink" href="#a" title="Permanent link">&para;</a></h1>
<p><img alt="" src="../../images/7485616-6f8ca13e43c8c3be.png" />    </p>
<p>试试朋友的想法    </p>
<blockquote>
<p>假如设置一个均值（一直在变），低于0.8倍均值（mean_coe），并且连续fall_days天，跌幅加起来达到fall_x%，买入  <br />
高于买入价格，并且连续rise_days天，涨幅加起来达到rise_x%，卖出    </p>
</blockquote>
<p>我开始简单的设置了几个参数，发现结果不是很理想，但是没亏，我就想可能是参数的问题，然后列出了个集合，想着再跑跑，代码如下：    </p>
<pre><code>#!/usr/bin/python3    
# encoding: utf-8     
# @Time    : 2020/11/22 16:33    
# @author  : zza    
# @Email   : 740713651@qq.com    
import itertools    

import numpy    
import pandas    
from rqalpha.apis import *    

__config__ = {    
    &quot;base&quot;: {    
        &quot;start_date&quot;: &quot;20190101&quot;,    
        &quot;end_date&quot;: &quot;20191231&quot;,    
        'frequency': '1d',    
        &quot;accounts&quot;: {    
            &quot;stock&quot;: 50000,    
        },    
        &quot;data_bundle_path&quot;: r&quot;E:\data\bundle&quot;,    
    },    
    &quot;extra&quot;: {    
        &quot;log_level&quot;: &quot;debug&quot;,    
    },    
    &quot;mod&quot;: {    
        &quot;sys_progress&quot;: {    
            &quot;enabled&quot;: True,    
            &quot;show&quot;: True    
        }, &quot;sys_accounts&quot;: {    
            &quot;enabled&quot;: True,    
            &quot;dividend_reinvestment&quot;: True,    
        },    
        &quot;sys_analyser&quot;: {    
            &quot;enabled&quot;: True,    
            &quot;plot&quot;: True,    
            'benchmark': '000300.XSHG',    
        },    
    },    
}    


def init(context):    
    context.mean_coe = 0.8    
    context.mean_days = 244    
    context.rise_days = context.config.extra.rise_days    
    context.fall_days = context.config.extra.fall_days    
    context.rise_x = context.config.extra.rise_x    
    context.fall_x = context.config.extra.fall_x    
    context.order_ticker = [    
        &quot;002111.XSHE&quot;,  # 威海广泰    
        &quot;002673.XSHE&quot;,  # 西部证券    
        &quot;601375.XSHG&quot;,  # 中原证券    
    ]    

    df = all_instruments('CS')    
    df = df[df.listed_date.apply(lambda x: x.year in [2015, 2016, 2017])]    
    context.order_ticker = context.order_ticker + df.order_book_id.to_list()    


def before_trading(context):    
    print(&quot;年化:{}&quot;.format(context.portfolio.total_returns))    
    # 价格均值    
    context.mean_close = {}    
    for order_book_id in context.order_ticker:    
        bars = pandas.Series([i[0] for i in history_bars(order_book_id, context.mean_days, &quot;1d&quot;, fields=['close'])])    
        context.mean_close[order_book_id] = bars.mean()    


def handle_bar(context, bar_dict):    
    # for buy    
    if context.stock_account.cash &gt;= 5000:    

        for order_book_id in context.order_ticker:    
            bar_close = bar_dict[order_book_id].close    
            if bar_close &lt; (context.mean_close[order_book_id] * context.mean_coe):    
                _str = &quot;&quot;    
                bars = pandas.Series(    
                    [i[0] for i in history_bars(order_book_id, context.fall_days, &quot;1d&quot;, fields=['close'])])    
                _str += &quot;\n&quot; + f&quot;[{order_book_id}]价格({bar_close})低于一年平均价{context.mean_close[order_book_id]}&quot;    
                if not (bars.shift(-1, fill_value=0) &lt; bars).all():    
                    # 判断连跌    
                    continue    
                _str += &quot;\n&quot; + f&quot;[{order_book_id}]连跌 价格表现为{list(bars)}&quot;    
                if not (bars[0] * context.fall_x &gt; bar_close):    
                    # 判断跌幅    
                    # 非低于0.8倍均值（mean_coe）    
                    continue    
                _str += &quot;\n&quot; + f&quot;[{order_book_id}]跌幅超过{context.fall_x}, {bars[0]} - {bar_close}&quot;    
                o = order_value(order_book_id, 5000)    
                if o:    
                    _str += &quot;\n&quot; + f&quot;[{order_book_id}]买入&quot;.format(order_book_id)    
                    print(_str)    
    # for sell    
    for order_book_id in context.order_ticker:    
        position = context.portfolio.positions[order_book_id]    
        bar_close = bar_dict[order_book_id].close    
        if position is None or position.quantity &lt;= 0:    
            continue    
        if position.avg_price &lt; bar_close:    
            # 低于买入价格 不做操作    
            continue    
        _str = &quot;&quot;    
        bars = pandas.Series([i[0] for i in history_bars(order_book_id, context.fall_days, &quot;1d&quot;, fields=['close'])])    
        if not (bars.shift(1, fill_value=0) &lt; bars).all():    
            # 并且连续rise_days天    
            continue    
        _str += &quot;\n&quot; + f&quot;[{order_book_id}]连涨 价格表现为{list(bars)}&quot;    
        if not (bars[0] * context.rise_x &lt; bar_close):    
            # 涨幅加起来达到rise_x%    
            continue    
        _str += &quot;\n&quot; + f&quot;[{order_book_id}]涨幅超过{context.rise_x}, {bars[0]} - {bar_close}&quot;    
        o = order_target_percent(order_book_id, 0)    
        if o:    
            _str += &quot;\n&quot; + f&quot;[{order_book_id}]出售&quot;.format(order_book_id)    
            print(_str)    


def after_trading(context):    
    pass    


import rqalpha    

rise_days = range(3, 10)    
fall_days = range(3, 10)    
rise_x = numpy.arange(1.06, 1.12, 0.01)    
fall_x = numpy.arange(0.9, 0.94, 0.01)    
config_map = itertools.product(rise_days, fall_days, rise_x, fall_x)    

df = pandas.DataFrame(config_map, columns=[&quot;rise_days&quot;, &quot;fall_days&quot;, &quot;rise_x&quot;, &quot;fall_x&quot;, ])    
result_list = []    
for _, item in df.iterrows():    
    __config__['extra']['rise_days'] = int(item.rise_days)    
    __config__['extra']['fall_days'] = int(item.fall_days)    
    __config__['extra']['rise_x'] = item.rise_x    
    __config__['extra']['fall_x'] = item.fall_x    
    result = rqalpha.run_func(init=init,    
                              before_trading=before_trading,    
                              handle_bar=handle_bar,    
                              after_trading=after_trading,    
                              config=__config__)    
    total_returns = result['sys_analyser']['summary']['total_value']    
    result_list.append(result)    

</code></pre>
<p>其实跑出了几个超过大盘收益的结果。但是因为我的代码水平问题，报错了，结果也没保存，近期我会去吧这个跑完（1300多的组合方式），有结果了我会贴上最优解的。    </p>
<hr />
<h1 id="_5">总结<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h1>
<p>我还是不在股票市场里当韭菜了  <br />
溜了溜了    </p>
<p><img alt="" src="../../images/7485616-cce1eced60c6d8df.png" />    </p></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../js/base.js" defer></script>
        <script src="../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
